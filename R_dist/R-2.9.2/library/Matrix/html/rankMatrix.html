<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Rank of a Matrix</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for rankMatrix {Matrix}"><tr><td>rankMatrix {Matrix}</td><td align="right">R Documentation</td></tr></table>
<h2>Rank of a Matrix</h2>


<h3>Description</h3>

<p>
Compute the rank of matrix, a well-defined functional in theory,
somewhat ambigous in practice.  We provide several methods, the
default corresponding to Matlab's definition.
</p>


<h3>Usage</h3>

<pre>
rankMatrix(x, tol = NULL,
           method = c("tolNorm2", "qrLINPACK", "useGrad", "maybeGrad"),
           sval = svd(x, 0, 0)$d)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
numeric matrix, of dimension <i>n x m</i>, say.</td></tr>
<tr valign="top"><td><code>tol</code></td>
<td>
nonnegative number specifying a tolerance for
&ldquo;practically zero&rdquo; with specific meaning depending on
<code>method</code>; by default, <code>max(dim(x)) *
      <a href="../../base/html/zMachine.html">.Machine</a>$double.eps * abs(max(sval))</code> is according to
Matlab's default (for its only <code>method</code> "tolNorm2").</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
a character string specifying the computational method,
can be abbreviated:
<dl>
<dt>tolNorm2</dt><dd>the number of singular values <code>&gt;= tol</code>;</dd>
<dt>qrLINPACK</dt><dd>= <code><a href="qr-methods.html">qr</a>(x, tol, LAPACK=FALSE)$rank</code>;
this used to be <EM>the</EM> recommended way to compute a matrix
rank for a while in the past.  For this method, <code>sval</code> are
not used (nor computed).</dd>
<dt>useGrad</dt><dd>considering the &ldquo;gradient&rdquo; of the
(decreasing) singular values, the index of the <EM>smallest</EM> gap.</dd>
<dt>maybeGrad</dt><dd>choosing method <code>"useGrad"</code> only when that
seems <EM>reasonable</EM>; otherwise using <code>"tolNorm2"</code>.</dd>
</dl>
</td></tr>
<tr valign="top"><td><code>sval</code></td>
<td>
numeric vector of non-increasing singular values of
<code>x</code>; typically unspecified and computed from <code>x</code>.</td></tr>
</table>

<h3>Value</h3>

<p>
positive integer in <code>1:min(dim(x))</code>, with attributes detailing
the method used.</p>

<h3>Author(s)</h3>

<p>
Martin Maechler; for the "*Grad" methods, building on
suggestions by Ravi Varadhan.
</p>


<h3>See Also</h3>

<p>
<code><a href="qr-methods.html">qr</a></code>, <code><a href="../../base/html/svd.html">svd</a></code>.
</p>


<h3>Examples</h3>

<pre>
rankMatrix(cbind(1, 0, 1:3)) # 2

(meths &lt;- eval(formals(rankMatrix)$method))

## a "border" case:
H12 &lt;- Hilbert(12)
rankMatrix(H12, tol = 1e-20) # 12;  but  11  with default method &amp; tol.
sapply(meths, function(.m.) rankMatrix(H12, method = .m.))
## tolNorm2 qrLINPACK   useGrad maybeGrad
##       11        12        11        11
</pre>



<hr><div align="center">[Package <em>Matrix</em> version 0.999375-30 <a href="00Index.html">Index</a>]</div>

</body></html>
