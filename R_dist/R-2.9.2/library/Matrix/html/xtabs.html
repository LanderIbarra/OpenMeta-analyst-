<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Cross Tabulation, Optionally Sparse</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for xtabs {Matrix}"><tr><td>xtabs {Matrix}</td><td align="right">R Documentation</td></tr></table>
<h2>Cross Tabulation, Optionally Sparse</h2>


<h3>Description</h3>

<p>
Create a contingency table from cross-classifying factors, usually
contained in a data frame, using a formula interface.
</p>
<p>
This is a fully compatible extension of the standard <span class="pkg">stats</span>
package <code><a href="../../stats/html/xtabs.html">xtabs</a>()</code> function with the added option
to produce a <EM>sparse</EM> matrix result via <code>sparse = TRUE</code>.
</p>


<h3>Usage</h3>

<pre>
xtabs(formula = ~., data = parent.frame(), subset, sparse = FALSE, na.action,
      exclude = c(NA, NaN), drop.unused.levels = FALSE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>formula</code></td>
<td>
a <a href="../../stats/html/formula.html">formula</a> object with the cross-classifying variables
(separated by <code>+</code>) on the right hand side (or an object which
can be coerced to a formula).  Interactions are not allowed.  On the
left hand side, one may optionally give a vector or a matrix of
counts; in the latter case, the columns are interpreted as
corresponding to the levels of a variable.  This is useful if the
data have already been tabulated, see the examples below.</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>
an optional matrix or data frame (or similar: see
<code><a href="../../stats/html/model.frame.html">model.frame</a></code>) containing the variables in the
formula <code>formula</code>.  By default the variables are taken from
<code>environment(formula)</code>.</td></tr>
<tr valign="top"><td><code>subset</code></td>
<td>
an optional vector specifying a subset of observations
to be used.</td></tr>
<tr valign="top"><td><code>sparse</code></td>
<td>
logical specifying if the result should be a
<EM>sparse</EM> matrix, i.e., inheriting from
<a href="sparseMatrix-class.html">sparseMatrix</a>.  Only works for two factors (since there
are no higher-order sparse array classes yet).
</td></tr>
<tr valign="top"><td><code>na.action</code></td>
<td>
a function which indicates what should happen when
the data contain <code>NA</code>s.</td></tr>
<tr valign="top"><td><code>exclude</code></td>
<td>
a vector of values to be excluded when forming the
set of levels of the classifying factors.</td></tr>
<tr valign="top"><td><code>drop.unused.levels</code></td>
<td>
a logical indicating whether to drop unused
levels in the classifying factors.  If this is <code>FALSE</code> and
there are unused levels, the table will contain zero marginals, and
a subsequent chi-squared test for independence of the factors will
not work.</td></tr>
</table>

<h3>Details</h3>

<p>
For (non-sparse) <code>xtabs</code> results,
there is a <code>summary</code> method for contingency table objects created
by <code>table</code> or <code>xtabs</code>, which gives basic information and
performs a chi-squared test for independence of factors (note that the
function <code><a href="../../stats/html/chisq.test.html">chisq.test</a></code> currently only handles 2-d tables).
</p>
<p>
If a left hand side is given in <code>formula</code>, its entries are simply
summed over the cells corresponding to the right hand side; this also
works if the lhs does not give counts.
</p>


<h3>Value</h3>

<p>
By default, when <code>sparse=FALSE</code>,
a contingency table in array representation of S3 class <code>c("xtabs",
    "table")</code>, with a <code>"call"</code> attribute storing the matched call.
<br>
When <code>sparse=TRUE</code>, a sparse numeric matrix, specifically an
object of S4 class <a href="dgTMatrix-class.html">dgTMatrix</a>.</p>

<h3>See Also</h3>

<p>
The <span class="pkg">stats</span> package version <code><a href="../../stats/html/xtabs.html">xtabs</a></code> and its
references.
</p>


<h3>Examples</h3>

<pre>
## See for non-sparse examples:
example(xtabs, package = "stats")

## similar to "nlme"s  'ergoStool' :
d.ergo &lt;- data.frame(Type = paste("T", rep(1:4, 9*4), sep=""),
                     Subj = gl(9,4, 36*4))
xtabs(~ Type + Subj, data=d.ergo) # 4 replicates each
set.seed(15) # a subset of cases:
xtabs(~ Type + Subj, data=d.ergo[sample(36, 10),], sparse=TRUE)

## Hypothetical two level setup:
inner &lt;- factor(sample(letters[1:25], 100, replace = TRUE))
inout &lt;- factor(sample(LETTERS[1:5], 25, replace = TRUE))
fr &lt;- data.frame(inner = inner, outer = inout[as.integer(inner)])
xtabs(~ inner + outer, fr, sparse = TRUE)
</pre>



<hr><div align="center">[Package <em>Matrix</em> version 0.999375-30 <a href="00Index.html">Index</a>]</div>

</body></html>
