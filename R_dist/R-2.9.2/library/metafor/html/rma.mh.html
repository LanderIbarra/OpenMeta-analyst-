<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Meta-Analysis via the Mantel-Haenszel Method</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for rma.mh {metafor}"><tr><td>rma.mh {metafor}</td><td align="right">R Documentation</td></tr></table>
<h2>Meta-Analysis via the Mantel-Haenszel Method</h2>


<h3>Description</h3>

<p>
Function to fit a fixed-effects model for data from 2x2 tables via the Mantel-Haenszel method.
</p>


<h3>Usage</h3>

<pre>
rma.mh(ai, bi, ci, di, n1i, n2i, data=NULL, 
       slab=NULL, subset=NULL, measure="OR", 
       add=c(1/2,0), to=c("only0","none"), level=95, digits=4)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>ai</code></td>
<td>
vector to specify the 2x2 table frequencies (upper left cell). See below and the documentation of the <code><a href="escalc.html">escalc</a></code> function for more details.</td></tr>
<tr valign="top"><td><code>bi</code></td>
<td>
vector to specify the 2x2 table frequencies (upper right cell). See below and the documentation of the <code><a href="escalc.html">escalc</a></code> function for more details.</td></tr>
<tr valign="top"><td><code>ci</code></td>
<td>
vector to specify the 2x2 table frequencies (lower left cell). See below and the documentation of the <code><a href="escalc.html">escalc</a></code> function for more details.</td></tr>
<tr valign="top"><td><code>di</code></td>
<td>
vector to specify the 2x2 table frequencies (lower right cell). See below and the documentation of the <code><a href="escalc.html">escalc</a></code> function for more details.</td></tr>
<tr valign="top"><td><code>n1i</code></td>
<td>
vector to specify the group sizes or row totals (first group). See below and the documentation of the <code><a href="escalc.html">escalc</a></code> function for more details.</td></tr>
<tr valign="top"><td><code>n2i</code></td>
<td>
vector to specify the group sizes or row totals (second group). See below and the documentation of the <code><a href="escalc.html">escalc</a></code> function for more details.</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>
an optional data frame containing the variables given to the arguments above.</td></tr>
<tr valign="top"><td><code>slab</code></td>
<td>
an optional vector with unique labels for the <i>k</i> studies.</td></tr>
<tr valign="top"><td><code>subset</code></td>
<td>
an optional vector indicating the subset of tables that should be used for the analysis. This can be a logical vector of length <i>k</i> or a numeric vector indicating the indices of the tables to include.</td></tr>
<tr valign="top"><td><code>measure</code></td>
<td>
a character string indicating the outcome measure to use for the meta-analysis: the odds ratio (<code>"OR"</code>), relative risk (<code>"RR"</code>), or risk difference (<code>"RD"</code>).</td></tr>
<tr valign="top"><td><code>add</code></td>
<td>
vector with two numbers indicating the amount to add to the cell frequencies of the 2x2 table. The first number is used in the calculation of the individual outcomes, the second number is used when applying the Mantel-Haenszel method. See below and the documentation of the <code><a href="escalc.html">escalc</a></code> function for more details.</td></tr>
<tr valign="top"><td><code>to</code></td>
<td>
a character vector with two strings indicating when the values under <code>add</code> should be added. When set to <code>"all"</code>, the value of <code>add</code> is added to each cell of the 2x2 tables in all <i>k</i> tables. When set to <code>"only0"</code>, the value of <code>add</code> is added to each cell of the 2x2 tables with at least one cell equal to 0. When set to <code>"if0all"</code>, the value of <code>add</code> is added to each cell of the 2x2 tables in all <i>k</i> studies, but only when there is at least one 2x2 table with a zero entry. Setting <code>to="none"</code> or <code>add=0</code> has the same effect: No adjustment to the observed table frequencies is made. The first string again applies when calculating the individual outcomes, the second string when applying the Mantel-Haenszel method. See below and the documentation of the <code><a href="escalc.html">escalc</a></code> function for more details.</td></tr>
<tr valign="top"><td><code>level</code></td>
<td>
a numerical value between 0 and 100 specifying the confidence interval level (default is 95).</td></tr>
<tr valign="top"><td><code>digits</code></td>
<td>
an integer specifying the number of decimal places to which the printed results should be rounded (default is 4).</td></tr>
</table>

<h3>Details</h3>

<p>
The studies providing data in terms of 2x2 tables are assumed to be of the form:
<table summary="Rd table">
<tr>
  <td align="left"></td>  <td align="center"> outcome 1 </td>  <td align="center"> outcome 2 </td>  <td align="center"> total </td>
</tr>
<tr>
  <td align="left"> group 1 </td>  <td align="center"> <code>ai</code> </td>  <td align="center"> <code>bi</code> </td>  <td align="center"> <code>n1i</code> </td>
</tr>
<tr>
  <td align="left"> group 2 </td>  <td align="center"> <code>ci</code> </td>  <td align="center"> <code>di</code> </td>  <td align="center"> <code>n2i</code> </td>
</tr>
</table>
<p>
where <code>ai</code>, <code>bi</code>, <code>ci</code>, and <code>di</code> denote the cell frequencies and <code>n1i</code> and <code>n2i</code> the row totals. For example, in a set of RCTs, group 1 and group 2 may refer to the treatment and placebo group, with outcome 1 denoting some event of interest and outcome 2 its complement. In a set of case-control studies, group 1 and group 2 may refer to the group of cases and the group of controls, with outcome 1 denoting, for example, exposure to some risk factor and outcome 2 non-exposure.
</p>
<p>
An approach for aggregating 2x2 table data of this type was suggested by Mantel and Haenszel (1959), which can be used in combination with the odds ratio, risk ratio, or risk difference (<code>measure="OR"</code>, <code>"RR"</code>, or <code>"RD"</code>). The Mantel-Haenszel method provides a weighted estimate under a fixed-effects model. The method is particularly advantageous when aggregating a large number of tables with small sample sizes (the so-called sparse data or increasing strata case). When analyzing odds ratios, the Cochran-Mantel-Haenszel test and Tarone's test for heterogeneity are also provided. When analyzing odds ratios and relative risks, the printed results are given both in terms of the log and the raw units (for easier interpretation).
</p>
<p>
The Mantel-Haenszel method itself does not require the calculation of the individual outcome values and directly makes use of the 2x2 table counts. Zero cells are not a problem (except in extreme cases, such as when one of the two outcomes never occurs in any of the tables). Therefore, it is also unnecessary to add some constant to the cell counts when there are zero cells. However, for plotting and various other functions, it is necessary to calculate the individual outcome values for the <i>k</i> tables. Here, zero cells can be problematic, so adding a constant value to the cell counts ensures that all <i>k</i> values can be calculated. The <code>add</code> and <code>to</code> arguments are used to specify what value should be added to the 2x2 cell frequencies and under what circumstances when calculating the individual outcome values and when applying the Mantel-Haenszel method.
</p>


<h3>Value</h3>

<p>
An object of class <code>c("rma.mh", "rma")</code>. The object is a list containing the following components:
</p>
<table summary="R argblock">
<tr valign="top"><td><code>b</code></td>
<td>
aggregated log odds ratio, log risk ratio, or risk difference.</td></tr>
<tr valign="top"><td><code>se</code></td>
<td>
standard error of the aggregated value.</td></tr>
<tr valign="top"><td><code>zval</code></td>
<td>
test statistics of the aggregated value.</td></tr>
<tr valign="top"><td><code>pval</code></td>
<td>
p-value for the test statistic.</td></tr>
<tr valign="top"><td><code>ci.lb</code></td>
<td>
lower bound of the confidence interval.</td></tr>
<tr valign="top"><td><code>ci.ub</code></td>
<td>
upper bound of the confidence interval.</td></tr>
<tr valign="top"><td><code>QE</code></td>
<td>
test statistic for the test of heterogeneity.</td></tr>
<tr valign="top"><td><code>QEp</code></td>
<td>
p-value for the test of heterogeneity.</td></tr>
<tr valign="top"><td><code>CMH</code></td>
<td>
Cochran-Mantel-Haenszel test statistic (only when <code>measure="OR"</code>).</td></tr>
<tr valign="top"><td><code>CMHp</code></td>
<td>
corresponding p-value (only when <code>measure="OR"</code>).</td></tr>
<tr valign="top"><td><code>TA</code></td>
<td>
Tarone's heterogeneity test statistic (only when <code>measure="OR"</code>).</td></tr>
<tr valign="top"><td><code>TAp</code></td>
<td>
corresponding p-value (only when <code>measure="OR"</code>).</td></tr>
<tr valign="top"><td><code>k</code></td>
<td>
number of tables included in the analysis.</td></tr>
<tr valign="top"><td><code>yi, vi</code></td>
<td>
the vector of individual outcomes and corresponding sampling variances.</td></tr>
<tr valign="top"><td><code>fit.stats</code></td>
<td>
a list with the log likelihood, deviance, AIC, and BIC values under the unrestricted and restricted likelihood.</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
some additional elements/values.</td></tr>
</table>
<p>

<br>
The results of the fitted model are neatly formated and printed with the <code><a href="print.rma.uni.html">print.rma.mh</a></code> function. If you also want the fit statistics, use <code><a href="print.rma.uni.html">summary.rma</a></code> (or use the <code><a href="fitstats.rma.html">fitstats.rma</a></code> function to extract them).
<br>
The <code><a href="residuals.rma.html">residuals.rma</a></code>, <code><a href="residuals.rma.html">rstandard.rma.mh</a></code>, and <code><a href="residuals.rma.html">rstudent.rma.mh</a></code> functions extract raw and standardized residuals. Leave-one-out diagnostics can be obtained with <code><a href="leave1out.rma.mh.html">leave1out.rma.mh</a></code>.
<br>
Forest, funnel, and radial plots of the individual outcomes can be obtained with <code><a href="forest.rma.html">forest.rma</a></code>, <code><a href="funnel.rma.html">funnel.rma</a></code>, and <code><a href="radial.rma.html">radial.rma</a></code>. The <code><a href="qqnorm.rma.uni.html">qqnorm.rma.mh</a></code> function provides a normal QQ plot of the standardized residuals. One can also just call <code><a href="plot.rma.uni.html">plot.rma.mh</a></code> on the fitted model object to obtain various plots at once.
<br>
A cumulative meta-analysis (i.e., adding one obervation at a time) can be obtained with <code><a href="cumul.rma.mh.html">cumul.rma.mh</a></code>.
<br>
Other assessor functions include <code><a href="coef.rma.html">coef.rma</a></code>, <code><a href="vcov.rma.html">vcov.rma</a></code>, and <code><a href="logLik.rma.html">logLik.rma</a></code>.</p>

<h3>Author(s)</h3>

<p>
Wolfgang Viechtbauer; <a href="mailto:wvb@www.wvbauer.com">wvb@www.wvbauer.com</a>; <a href="http://www.wvbauer.com/">http://www.wvbauer.com/</a>
</p>


<h3>References</h3>

<p>
Mantel, N. &amp; Haenszel, W. (1959) Statistical aspects of the analysis of data from retrospective studies of disease. <EM>Journal of the National Cancer Institute</EM>, <B>22</B>, 719&ndash;748.
</p>


<h3>Examples</h3>

<pre>
### load BCG vaccine data
data(dat.bcg)

### meta-analysis of the (log) odds ratios using the Mantel-Haenszel method
rma.mh(ai=tpos, bi=tneg, ci=cpos, di=cneg, data=dat.bcg, measure="OR")

### meta-analysis of the (log) risk ratios using the Mantel-Haenszel method
rma.mh(ai=tpos, bi=tneg, ci=cpos, di=cneg, data=dat.bcg, measure="RR")
</pre>



<hr><div align="center">[Package <em>metafor</em> version 0.5-7 <a href="00Index.html">Index</a>]</div>

</body></html>
